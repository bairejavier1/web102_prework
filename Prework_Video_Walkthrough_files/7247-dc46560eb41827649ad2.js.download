(self.webpackChunk_loomhq_web_client=self.webpackChunk_loomhq_web_client||[]).push([[7247],{7416:e=>{var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateAnonRecordingOwnership"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateAnonRecordingOwnership"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"updateAnonRecordingOwnershipPayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Error"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:187}};n.loc.source={body:"mutation UpdateAnonRecordingOwnership {\n  updateAnonRecordingOwnership {\n    ... on updateAnonRecordingOwnershipPayload {\n      success\n    }\n    ... on Error {\n      message\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function a(e,n){for(var i=0;i<e.definitions.length;i++){var a=e.definitions[i];if(a.name&&a.name.value==n)return a}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var a=n.type;"NamedType"===a.kind&&i.add(a.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.UpdateAnonRecordingOwnership=function(e,n){var t={kind:e.kind,definitions:[a(e,n)]};e.hasOwnProperty("loc")&&(t.loc=e.loc);var o=i[n]||new Set,r=new Set,d=new Set;for(o.forEach(function(e){d.add(e)});d.size>0;){var s=d;d=new Set,s.forEach(function(e){r.has(e)||(r.add(e),(i[e]||new Set).forEach(function(e){d.add(e)}))})}return r.forEach(function(n){var i=a(e,n);i&&t.definitions.push(i)}),t}(n,"UpdateAnonRecordingOwnership")},14359:e=>{var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetVideoInfo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"video"},name:{kind:"Name",value:"getVideo"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RegularUserVideo"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"owner_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:155}};n.loc.source={body:"query GetVideoInfo($id: ID!) {\n  video: getVideo(id: $id) {\n    ... on RegularUserVideo {\n      id\n      owner_id\n      name\n      description\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function a(e,n){for(var i=0;i<e.definitions.length;i++){var a=e.definitions[i];if(a.name&&a.name.value==n)return a}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var a=n.type;"NamedType"===a.kind&&i.add(a.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.GetVideoInfo=function(e,n){var t={kind:e.kind,definitions:[a(e,n)]};e.hasOwnProperty("loc")&&(t.loc=e.loc);var o=i[n]||new Set,r=new Set,d=new Set;for(o.forEach(function(e){d.add(e)});d.size>0;){var s=d;d=new Set,s.forEach(function(e){r.has(e)||(r.add(e),(i[e]||new Set).forEach(function(e){d.add(e)}))})}return r.forEach(function(n){var i=a(e,n);i&&t.definitions.push(i)}),t}(n,"GetVideoInfo")},38612:(e,n,i)=>{"use strict";i.d(n,{Z:()=>f});var a=i(42579),t=i(74932),o=i(43975),r=i(46153),d=i(14026),s=i(3805),c=i(13945),l=i(87501),m=i(5799),u=i(23604);let p={},v=(0,m.J1)`
    mutation UtilityCreateVideoComment($videoId: ID!, $content: String!, $timestamp: Int!, $mentions: VideoCommentContentMentionsInput, $password: String, $anonUserName: String, $parentPostId: Int) {
  createVideoComment(
    videoId: $videoId
    content: $content
    timestamp: $timestamp
    mentions: $mentions
    password: $password
    anonUserName: $anonUserName
    parentPostId: $parentPostId
  ) {
    avatar {
      name
      thumb
    }
    comment_post_id
    createdAt
    id
    content(withMentionMarkups: true)
    time_stamp
    user_id
    user_name
    anon_user_id
    children_comments {
      id
    }
  }
}
    `,f=e=>{let{showErrorBar:n}=(0,r.Nl)(),i=(0,d.FQu)(e??""),[m,{loading:f}]=function(e){let n={...p};return u.n(v,n)}();return{postComment:async({anonUserName:e,comment:o,creationMethod:r,onCompleted:d,parentPostId:c,timestamp:u,videoId:p})=>{let v=!!c;await m({variables:{anonUserName:e,content:o,parentPostId:c,password:void 0,timestamp:u||Math.round(i?.currentTime??0),videoId:p},onCompleted:e=>{let n=e.createVideoComment;l.track(v?t.IGY:t.rh0,{comment_id:n?.id,video_id:p,creation_method:r,comment_length:n?.content?.length}),d?.(e)},onError:e=>{n({message:"Unable to create comment",severity:a.MI.ERROR}),s.error(e,{videoId:p,message:"Error creating comment"},{team:"create"})}})},postRecordReplyComment:async({parentPostId:e,creationMethod:r,password:d,recordedReplyVideoId:u,videoId:p})=>{let v=`${o.J4}/share/${u}`;await m({variables:{anonUserName:null,content:v,parentPostId:e,password:d,timestamp:Math.round(i?.currentTime??0),videoId:p},onCompleted:e=>{let n=e.createVideoComment;l.track(t.rh0,{comment_id:n?.id,video_id:p,creation_method:r,comment_length:n?.content?.length})},onError:e=>{n({message:"Unable to create comment",severity:a.MI.ERROR}),s.error(e,{message:"Failed to create a comment for anonymous record a reply"},{feature:c.Xj.CommentReactions})}})},isCreatingComment:f}}},41773:(e,n,i)=>{"use strict";i.d(n,{T:()=>u});var a=i(74932),t=i(3805),o=i(81586),r=i(87501),d=i(5799);let s=(0,d.J1)`
    fragment ReactionFragment on PublicVideoReaction {
  id
  time
  user {
    id
    display_name
  }
  reaction
  extended_reaction
  anon_user_id
  anon_user_name
  locallyCreated @client
  localId @client
}
    `;var c=i(23604);let l={},m=(0,d.J1)`
    mutation addVideoReaction($videoId: ID!, $time: Int!, $type: String!, $userName: String, $password: String, $reactionType: ReactionType) {
  addVideoReaction(
    videoId: $videoId
    time: $time
    type: $type
    userName: $userName
    password: $password
    reactionType: $reactionType
  ) {
    ...ReactionFragment
  }
}
    ${s}`,u=()=>{let[e]=function(e){let n={...l};return c.n(m,n)}();return{createEmojiReaction:({videoId:n,time:i,type:d,placeUsed:s=""})=>{let c=(0,o.Bs)(d);e({variables:{videoId:n,time:i,type:d,reactionType:c},fetchPolicy:"no-cache",onCompleted:()=>{r.track(a.mrA,{video_id:n,sentiment:d,place_used:s,freshPlayer:!0})},onError:e=>{t.warning(e,{message:"There was an error reacting to video"})}})}}}},63407:(e,n,i)=>{"use strict";i.d(n,{G5:()=>l,OC:()=>m,c:()=>u});var a=i(31924);i(92406);var t=i(85301),o=i.n(t),r=i(14359),d=i.n(r),s=i(7416),c=i.n(s);let l=e=>(0,a.Xc)().query({query:d(),variables:{id:e}}),m=e=>(0,a.Xc)().mutate({mutation:o(),variables:{...e}}),u=()=>(0,a.Xc)().mutate({mutation:c()})},67247:(e,n,i)=>{"use strict";i.d(n,{e:()=>R});var a=i(42579),t=i(74932),o=i(43975),r=i(38612),d=i(46153),s=i(37060),c=i(45958),l=i(41773),m=i(14026),u=i(43636),p=i(3805),v=i(80965),f=i(66865),k=i(13945),h=i(87501),g=i(92406),y=i(63407);let{SignedOutEndOfVideoNudges:w,SignedOutAiEndOfVideoNudges:S,SignedOutEndOfVideoNudgesEmojiReactions:I,AnonDownloadVideoOnSharePage:N}=c.rC,R=e=>{let{showErrorBar:n}=(0,d.Nl)(),{createEmojiReaction:i}=(0,l.T)(),{options:R}=(0,s.U)(),{postComment:b,postRecordReplyComment:V}=(0,r.Z)(e);return{anonShareGateAfterOauthLogin:async({provider:e,videoId:n})=>{let{data:a}=await (0,f.wr)(),r=new URL(window.location.href.split("?")[0]),{comment:d,emojiReaction:s,videoOwnerName:l,source:p,parentPostId:k,onboardingType:y}=R,V=a.me.checklist.complete_onboarding;if(d&&n&&b({comment:d,anonUserName:null,...k&&{parentPostId:k},videoId:n}),s&&n){let e=R?.currentVideoTime;i({type:s,time:1e3*e,videoId:n,placeUsed:m.Xkj.sharePagePlayer})}if(!V){if("modal-onboarding"===y){r.searchParams.append("resume-anon-signup","true"),window.location.href=r.href;return}switch(p){case S:case w:(0,g.eb)(u.aY,JSON.stringify({videoOwnerName:l,commentVideoId:n}));break;case I:(0,g.eb)(u.k9,JSON.stringify({videoOwnerName:l,emojiReactVideoId:n}))}if(p===N){window.location.href=`${o.J4}${o.R1}?redirect_to_share=${n}&start_download=true`;return}window.location.href=`${o.J4}${o.R1}`;return}V?(h.track(t.BZ5,{provider:e,isSignUp:!1,source:c.lI}),(0,v.Ys)("button.click",{context:t.BZ5,provider:e,isSignUp:!1,source:c.lI}),p===N&&r.searchParams.append("start_download","true")):(r.searchParams.append("resume-anon-signup","true"),h.track(t.BZ5,{provider:e,isSignUp:!0,source:c.lI}),(0,v.Ys)("button.click",{context:t.BZ5,provider:e,isSignUp:!0,source:c.lI})),window.location.href=r.href},highlightValueOfLoomAfterOauthLogin:()=>new Promise(e=>{let n=new URL(window.location.href);window.location.href=n.href,e()}),afterOauthLogin:async({videoId:e,addReplyId:i,password:o,videoCurrentTime:r,repliedToVideoId:d,provider:s})=>{let{data:l}=await (0,f.wr)(),m=new URL(window.location.href);try{await (0,y.OC)({replyVideoId:e,repliedToVideoId:d,videoCurrentTime:r,addReplyId:i})}catch(e){n({message:"There was an error.",severity:a.MI.ERROR}),p.error(e,{message:"Failed to create a Redis link for anonymous record a reply"},{feature:k.Xj.SDKRecorder})}if(r&&m.searchParams.append("videoCurrentTime",r),l.me.checklist.complete_onboarding&&d&&i){V({recordedReplyVideoId:e,parentPostId:Number(i),password:o,videoId:d}),h.track(t.BZ5,{provider:s,isSignUp:!1,source:c.WL}),(0,v.Ys)("button.click",{context:t.BZ5,provider:s,isSignUp:!1,source:c.WL});try{await (0,y.c)()}catch(e){n({message:"There was an error.",severity:a.MI.ERROR}),p.error(e,{message:"Failed to transfer video ownership for anonymous record a reply"},{feature:k.Xj.SDKRecorder})}}else e&&m.searchParams.append("replyVideoId",e),i&&m.searchParams.append("addReplyId",i),h.track(t.BZ5,{provider:s,isSignUp:!0,source:c.WL}),(0,v.Ys)("button.click",{context:t.BZ5,provider:s,isSignUp:!0,source:c.WL});window.location.href=m.href}}}},85301:e=>{var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CreateAnonRecordingCache"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"replyVideoId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"repliedToVideoId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"videoCurrentTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"addReplyId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createAnonRecordingCache"},arguments:[{kind:"Argument",name:{kind:"Name",value:"replyVideoId"},value:{kind:"Variable",name:{kind:"Name",value:"replyVideoId"}}},{kind:"Argument",name:{kind:"Name",value:"repliedToVideoId"},value:{kind:"Variable",name:{kind:"Name",value:"repliedToVideoId"}}},{kind:"Argument",name:{kind:"Name",value:"videoCurrentTime"},value:{kind:"Variable",name:{kind:"Name",value:"videoCurrentTime"}}},{kind:"Argument",name:{kind:"Name",value:"addReplyId"},value:{kind:"Variable",name:{kind:"Name",value:"addReplyId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"createAnonRecordingCachePayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Error"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:426}};n.loc.source={body:"mutation CreateAnonRecordingCache(\n  $replyVideoId: String!\n  $repliedToVideoId: String!\n  $videoCurrentTime: Float\n  $addReplyId: String\n) {\n  createAnonRecordingCache(\n    replyVideoId: $replyVideoId\n    repliedToVideoId: $repliedToVideoId\n    videoCurrentTime: $videoCurrentTime\n    addReplyId: $addReplyId\n  ) {\n    ... on createAnonRecordingCachePayload {\n      success\n    }\n    ... on Error {\n      message\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function a(e,n){for(var i=0;i<e.definitions.length;i++){var a=e.definitions[i];if(a.name&&a.name.value==n)return a}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var a=n.type;"NamedType"===a.kind&&i.add(a.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.CreateAnonRecordingCache=function(e,n){var t={kind:e.kind,definitions:[a(e,n)]};e.hasOwnProperty("loc")&&(t.loc=e.loc);var o=i[n]||new Set,r=new Set,d=new Set;for(o.forEach(function(e){d.add(e)});d.size>0;){var s=d;d=new Set,s.forEach(function(e){r.has(e)||(r.add(e),(i[e]||new Set).forEach(function(e){d.add(e)}))})}return r.forEach(function(n){var i=a(e,n);i&&t.definitions.push(i)}),t}(n,"CreateAnonRecordingCache")}}]);
//# sourceMappingURL=https://www.loom.com/admin/sourcemaps/js/7247-dc46560eb41827649ad2.js.map