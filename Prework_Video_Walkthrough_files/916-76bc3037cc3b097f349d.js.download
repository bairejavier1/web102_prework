(self.webpackChunk_loomhq_web_client=self.webpackChunk_loomhq_web_client||[]).push([[916],{2869:(e,n,i)=>{"use strict";i.d(n,{$1:()=>m,A8:()=>t,CB:()=>d,EZ:()=>o,LY:()=>u,OW:()=>a,eV:()=>c,p1:()=>l,z6:()=>r,zL:()=>s});let t="google",a="google-id-token",r="slack",o="slack-openid-connect",d="windows",s="auth0",l="apple",c="workos",u="atlassian",m=[s,c]},7317:e=>{var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetPrimaryAuthTypeForEmail"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"email"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"requestSource"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"response"},name:{kind:"Name",value:"getPrimaryAuthTypeForEmail"},arguments:[{kind:"Argument",name:{kind:"Name",value:"email"},value:{kind:"Variable",name:{kind:"Name",value:"email"}}},{kind:"Argument",name:{kind:"Name",value:"requestSource"},value:{kind:"Variable",name:{kind:"Name",value:"requestSource"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GetPrimaryAuthTypePayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"redirectUri"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Error"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:312}};n.loc.source={body:"query GetPrimaryAuthTypeForEmail($email: String!, $requestSource: String) {\n  response: getPrimaryAuthTypeForEmail(\n    email: $email\n    requestSource: $requestSource\n  ) {\n    __typename\n    ... on GetPrimaryAuthTypePayload {\n      authType\n      redirectUri\n    }\n    ... on Error {\n      message\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function t(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.GetPrimaryAuthTypeForEmail=function(e,n){var a={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var r=i[n]||new Set,o=new Set,d=new Set;for(r.forEach(function(e){d.add(e)});d.size>0;){var s=d;d=new Set,s.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){d.add(e)}))})}return o.forEach(function(n){var i=t(e,n);i&&a.definitions.push(i)}),a}(n,"GetPrimaryAuthTypeForEmail")},25445:(e,n,i)=>{"use strict";i.d(n,{g:()=>a});var t=i(55044);async function a(){let e=await (0,t.A)("https://location.loom.com",{method:"GET"});return{country:e.headers.get("x-loom-country")??"",city:e.headers.get("x-loom-city")??"",postalCode:e.headers.get("x-loom-postal-code")??"",latitude:parseFloat(e.headers.get("x-loom-latitude")??""),longitude:parseFloat(e.headers.get("x-loom-longitude")??"")}}},47908:(e,n,i)=>{"use strict";i.d(n,{n:()=>o});var t=i(31924),a=i(50343),r=i.n(a);let o=async(e,n)=>{let i=(0,t.Xc)(),{data:{acceptInviteLinkInvitation:a}}=await i.mutate({mutation:r(),variables:{inviteLinkId:e,isNewUser:n}});return a}},50343:e=>{var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AcceptInviteLinkInvitation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"inviteLinkId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isNewUser"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"acceptInviteLinkInvitation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"inviteLinkId"},value:{kind:"Variable",name:{kind:"Name",value:"inviteLinkId"}}},{kind:"Argument",name:{kind:"Name",value:"isNewUser"},value:{kind:"Variable",name:{kind:"Name",value:"isNewUser"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AcceptInviteLinkInvitationPayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"redirect"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GenericError"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InviteLinkDisabledError"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"redirect"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InviteLinkNotFoundError"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"redirect"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InviteLinkWorkspaceSsoError"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"redirect"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:555}};n.loc.source={body:"mutation AcceptInviteLinkInvitation($inviteLinkId: ID!, $isNewUser: Boolean!) {\n  acceptInviteLinkInvitation(\n    inviteLinkId: $inviteLinkId\n    isNewUser: $isNewUser\n  ) {\n    __typename\n    ... on AcceptInviteLinkInvitationPayload {\n      success\n      redirect\n    }\n    ... on GenericError {\n      message\n      error\n    }\n    ... on InviteLinkDisabledError {\n      success\n      redirect\n    }\n    ... on InviteLinkNotFoundError {\n      success\n      redirect\n    }\n    ... on InviteLinkWorkspaceSsoError {\n      success\n      redirect\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function t(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.AcceptInviteLinkInvitation=function(e,n){var a={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var r=i[n]||new Set,o=new Set,d=new Set;for(r.forEach(function(e){d.add(e)});d.size>0;){var s=d;d=new Set,s.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){d.add(e)}))})}return o.forEach(function(n){var i=t(e,n);i&&a.definitions.push(i)}),a}(n,"AcceptInviteLinkInvitation")},75587:(e,n,i)=>{"use strict";i.d(n,{FB:()=>o,b7:()=>r,lD:()=>a,o8:()=>d});var t=i(63814);let a=e=>({type:t.Yx,err:e}),r=e=>({type:t.AX,isFetching:e}),o=e=>({type:t.iK,err:e}),d=e=>({type:t.hj,err:e})},78203:(e,n,i)=>{"use strict";i.d(n,{A:()=>r});var t=i(43975),a=i(51359);let r=e=>!!(e&&!e.startsWith(t.J4)&&e!==t.hD&&!function(e){return"/"==e[0]&&(1==e.length||"/"!=e[1]&&"\\"!=e[1])}(e)&&!e.startsWith(a._8)&&!e.startsWith(t.eP))},80916:(e,n,i)=>{"use strict";i.d(n,{AE:()=>R,CW:()=>J,W2:()=>B,iD:()=>G,w9:()=>x});var t=i(97985),a=i(43975),r=i(66330),o=i(14666),d=i(55044),s=i(31924),l=i(94731),c=i(25445),u=i(3805),m=i(24628),v=i(56389),k=i(66865),p=i(92184),f=i(75608),y=i(90070),g=i(2869),h=i(56036),S=i(38275),w=i(13945),N=i(26545),I=i(75587),b=i(7317),F=i.n(b),E=i(57001),L=i.n(E),_=i(87501),A=i(94848),T=i(47908),D=i(78203),U=i(21321);i(99550);var P=i(11902);let{uh:q}=f;function V(e){return"object"==typeof e&&null!==e&&"created"in e&&"boolean"==typeof e.created&&"error"in e&&("string"==typeof e.error||null===e.error)&&"loginSuccess"in e&&"boolean"==typeof e.loginSuccess&&"type"in e&&"string"==typeof e.type&&"userRole"in e&&"string"==typeof e.userRole&&(!("redirect_after"in e)||"string"==typeof e.redirect_after)}let C=e=>{(0,s.Xc)().mutate({mutation:L(),variables:{name:N.qp.SIGNUP_LOCATION,value:e}}).then(({data:e})=>{let{success:n}=e;return n})},O=()=>{try{(0,c.g)().then(e=>{C(e.country)}).catch(e=>{u.warning(e,{message:"Failed to get update location",team:w.u.Billing})})}catch(e){u.warning(e,{message:"Failed to get fetch location",team:w.u.Billing})}},$=async e=>{let n;let i=e.deeplink_uri;if(e.invalidLogin||i&&(0,D.A)(i)){(0,k.y4)();return}let t=(0,v.sF)("redirect_after"),r=(0,v.sF)("orgToken")||(0,v.sF)("orgTokenForMemberPreview"),o=(0,v.sF)("invite_link_id"),d=(0,v.sF)("companyID"),s=(0,v.sF)("redirect");if(d&&q(d)&&s&&!(0,D.A)(s)){window.location.reload();return}if(e.loginSuccess){if(e.created){n=new URL(a.J4+a.R1);try{await O()}catch(e){u.warning(e,{message:"unable to update user location",team:w.u.Billing})}}else if(t){let e=window.decodeURIComponent(t);(0,D.A)(e)&&(e="/"),n=new URL(e,a.J4)}else if(e.redirect_after){let i=window.decodeURIComponent(e.redirect_after);(0,D.A)(i)&&(i="/"),n=new URL(i,a.J4)}else n=new URL(a.J4+a.AA)}else n=new URL(a.J4+a.m0);if(null!=e.error&&n.searchParams.set("oauth_error",e.error),r)try{await (0,U.uX)(r)}catch{P.error("TeamInvite: Unable to accept invite after oauth")}else if(o)try{let{success:n,__typename:i}=await (0,T.n)(o,e.created);"GenericError"!==i&&n||u.warning(Error("InviteLink: Unable to process link after oauth authorization"),{invite_link_id:o,accept_failure_reason:i})}catch(e){u.warning(e`InviteLink: Unable to process link after oauth authorization`,{invite_link_id:o,error_message:e.message})}e.loginSuccess?A.b0(()=>{let e=n.toString();i&&window.location.replace(i),window.location.href=e}):window.location.href=n.toString()},G=(e,n)=>{let{query:i}=r.parse(window.location.search||"",!0),t={pathname:a.S3,query:{app_source:y.y7,...i}},o=r.format(t);return(0,d.A)(o,{method:"POST",headers:{[h.VX]:S.ZX},body:JSON.stringify({email:e,password:n})})},R=(e,n={},i=$)=>{let r=new URL(`${a.J4}/api/auth/${e}`),d=new URLSearchParams(r.search);Object.keys(n).map(e=>d.set(e,n[e]));let s=(0,v.sF)("app_source")||y.y7;d.set("app_source",s),_.ready(()=>{let{anonID:e}=_.getAnalyticsIds();d.set("anon_id",e),(0,o.j)()&&d.set("device_id",window.amplitude.getInstance().options.deviceId);let n=`${r.toString()}?${d.toString()}`,s=window.open(n,`loom_${(0,p.A)()}_popup`,"width=600,height=800"),c=e=>{let n;try{let r=new URL(e.origin)?.origin;if(["https://js.stripe.com"].includes(r))return;if("string"==typeof e.data)n=(0,l.ob)(e.data,{type:"default-oauth-type"},V),"default-oauth-type"===n.type&&u.warning(Error("Malformed auth data, falling back to default oauth type"),{event:e,team:w.u.Outreach}),(r!==a.J4||n.type!==t.E)&&(n.invalidLogin=!0),window.removeEventListener("message",c),s?.close(),i(n);else throw Error("Malformed oauth data")}catch(n){u.error("Auth Error",{message:n.message,origin:e.origin,team:w.u.Outreach,event:e},{feature:w.Xj.Authentication});return}};window.addEventListener("message",c)})},x=()=>{m.M.dispatch((0,I.lD)(null)),m.M.dispatch((0,I.o8)(null)),m.M.dispatch((0,I.FB)(null))},J=(e,n)=>(0,s.Xc)().query({query:F(),variables:{email:e,requestSource:n},fetchPolicy:"no-cache"}),B=(e,n)=>e!==g.eV&&(!n||!!(0,D.A)(n)||e.includes("desktop"))}}]);
//# sourceMappingURL=https://www.loom.com/admin/sourcemaps/js/916-76bc3037cc3b097f349d.js.map